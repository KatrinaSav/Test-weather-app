# Описание проекта

Система  состоит  из  двух  частей:  RESTful  API  сервиса  для  фильтрации  и сортировки  данных  о  погоде  (далее  “сервер”),  а  также  как  минимум  одного сервиса, предоставляющим  данные  о  погоде  (далее  “сенсор”).

Сенсор  представляет  из  себя  приложение,  которое  может  зарегистрировать  себя 
на  сервере.  Далее  через  определенные  промежутки  времени,  сенсор  сообщает 
данные  о  погоде  серверу.  Сервер  принимает  данные  от  сенсора  и  сохраняет  их  в БД.  Клиент  может  получать  данные  с  сервера  о  имеющихся  сенсорах  и  измерениях погоды.

Реализация сервера расположена в WeatherApi, а сенсора – SensorClient.

# Запуск системы

## Клиент

В командной строке перейдите в директорию проекта `SensorClient`, где находится файл `pom.xml`, и выполните команду:

```bash
mvn clean compile
```

Далее выполните команду:

```bash
mvn exec:java -Dexec.mainClass=org.example.Main
```

## Сервер

Перед запуском сервера необходимо настроить базу данных PostreSQL. Для этого в папке weatherAPI\scr\main\resources отредактируйте файл application.properties следующие поля:
* spring.datasource.url= {url БД}
* spring.datasource.username={владелец бд} имя владельца БД (по умолчанию postgres)
* spring.datasource.password={пароль} Пароль



В командной строке перейдите в директорию проекта `WeatherApi`, где находится файл `pom.xml`, и выполните команду:

```bash
mvn clean compile
```

Далее выполните команду:

```bash
mvn exec:java -Dexec.mainClass=com.example.weatherAPI.WeatherApiApplication
```

# Документация API для системы сбора и обработки данных о погоде

## Введение

Данная документация описывает API системы для сбора и обработки данных о погоде. Система состоит из двух основных компонентов: сервера (RESTful API сервиса) и сенсоров, предоставляющих данные о погоде.

## 1. Регистрация сенсора

### Запрос

Метод: POST

Путь: /sensors/registration

Тело запроса:
```json
{
  "name": "Sensor name"
}
```
### Ответ
```
{
  "key": "8bcb5ffa-ff4d-4214-a727-bb01ab90ceaa"
}
```
### Ошибки

- 400 Bad Request: Если сенсор с таким названием уже существует или название сенсора некорректно.

## 2. Отправка данных о погоде от сенсора

### Запрос

Метод: POST

Путь: /sensors/{key}/measurements

Тело запроса:
```json
{
  "value": 24.5,
  "raining": false
}
```
### Ошибки

- 400 Bad Request: Если данные не проходят валидацию (например, неверный формат температуры).

## 3. Получение всех активных сенсоров

### Запрос

Метод: GET

Путь: /sensors

### Ответ

```json
  {
		"name": "1332",
		"key": "658a72db-6a24-45fe-a2f6-2aa8e705884f",
		"id": 2,
		"active": true
	}
```

## 4. Получение информации о последних измерениях сенсора

### Запрос

Метод: GET

Путь: /sensors/{key}/measurements

### Ответ
```json
	[{
		"id": 49,
		"value": 34.5,
		"raining": false,
		"time": 1699881311526,
		"sensor": {
			"name": "Name",
			"key": "54939ceb-b53d-418d-a1ee-f4d9af7e193d",
			"id": 16,
			"active": true
		}
	}, {}]
```
## 5. Получение актуальной информации от всех сенсоров

### Запрос

Метод: GET

Путь: /sensors/measurements

### Ответ
```json
[{
		"id": 49,
		"value": 34.5,
		"raining": false,
		"time": 1699881311526,
		"sensor": {
			"name": "Name",
			"key": "54939ceb-b53d-418d-a1ee-f4d9af7e193d",
			"id": 16,
			"active": true
		}
	}, {}]
```
## 6. Обработка ошибок

API обрабатывает ошибки запросов и возвращает понятные сообщения:

- 400 Bad Request: Некорректный запрос или данные.
- 404 Not Found: Ресурс не найден.
- 500 Internal Server Error: Внутренняя ошибка сервера.
